{"ast":null,"code":"import { Subscriber } from '../Subscriber';\nimport { Subject } from '../Subject';\nexport function windowCount(windowSize, startWindowEvery = 0) {\n  return function windowCountOperatorFunction(source) {\n    return source.lift(new WindowCountOperator(windowSize, startWindowEvery));\n  };\n}\n\nclass WindowCountOperator {\n  constructor(windowSize, startWindowEvery) {\n    this.windowSize = windowSize;\n    this.startWindowEvery = startWindowEvery;\n  }\n\n  call(subscriber, source) {\n    return source.subscribe(new WindowCountSubscriber(subscriber, this.windowSize, this.startWindowEvery));\n  }\n\n}\n\nclass WindowCountSubscriber extends Subscriber {\n  constructor(destination, windowSize, startWindowEvery) {\n    super(destination);\n    this.destination = destination;\n    this.windowSize = windowSize;\n    this.startWindowEvery = startWindowEvery;\n    this.windows = [new Subject()];\n    this.count = 0;\n    destination.next(this.windows[0]);\n  }\n\n  _next(value) {\n    const startWindowEvery = this.startWindowEvery > 0 ? this.startWindowEvery : this.windowSize;\n    const destination = this.destination;\n    const windowSize = this.windowSize;\n    const windows = this.windows;\n    const len = windows.length;\n\n    for (let i = 0; i < len && !this.closed; i++) {\n      windows[i].next(value);\n    }\n\n    const c = this.count - windowSize + 1;\n\n    if (c >= 0 && c % startWindowEvery === 0 && !this.closed) {\n      windows.shift().complete();\n    }\n\n    if (++this.count % startWindowEvery === 0 && !this.closed) {\n      const window = new Subject();\n      windows.push(window);\n      destination.next(window);\n    }\n  }\n\n  _error(err) {\n    const windows = this.windows;\n\n    if (windows) {\n      while (windows.length > 0 && !this.closed) {\n        windows.shift().error(err);\n      }\n    }\n\n    this.destination.error(err);\n  }\n\n  _complete() {\n    const windows = this.windows;\n\n    if (windows) {\n      while (windows.length > 0 && !this.closed) {\n        windows.shift().complete();\n      }\n    }\n\n    this.destination.complete();\n  }\n\n  _unsubscribe() {\n    this.count = 0;\n    this.windows = null;\n  }\n\n}","map":{"version":3,"names":["Subscriber","Subject","windowCount","windowSize","startWindowEvery","windowCountOperatorFunction","source","lift","WindowCountOperator","constructor","call","subscriber","subscribe","WindowCountSubscriber","destination","windows","count","next","_next","value","len","length","i","closed","c","shift","complete","window","push","_error","err","error","_complete","_unsubscribe"],"sources":["c:/temp/module_federation_nx_mono_repo/node_modules/rxjs/_esm2015/internal/operators/windowCount.js"],"sourcesContent":["import { Subscriber } from '../Subscriber';\nimport { Subject } from '../Subject';\nexport function windowCount(windowSize, startWindowEvery = 0) {\n    return function windowCountOperatorFunction(source) {\n        return source.lift(new WindowCountOperator(windowSize, startWindowEvery));\n    };\n}\nclass WindowCountOperator {\n    constructor(windowSize, startWindowEvery) {\n        this.windowSize = windowSize;\n        this.startWindowEvery = startWindowEvery;\n    }\n    call(subscriber, source) {\n        return source.subscribe(new WindowCountSubscriber(subscriber, this.windowSize, this.startWindowEvery));\n    }\n}\nclass WindowCountSubscriber extends Subscriber {\n    constructor(destination, windowSize, startWindowEvery) {\n        super(destination);\n        this.destination = destination;\n        this.windowSize = windowSize;\n        this.startWindowEvery = startWindowEvery;\n        this.windows = [new Subject()];\n        this.count = 0;\n        destination.next(this.windows[0]);\n    }\n    _next(value) {\n        const startWindowEvery = (this.startWindowEvery > 0) ? this.startWindowEvery : this.windowSize;\n        const destination = this.destination;\n        const windowSize = this.windowSize;\n        const windows = this.windows;\n        const len = windows.length;\n        for (let i = 0; i < len && !this.closed; i++) {\n            windows[i].next(value);\n        }\n        const c = this.count - windowSize + 1;\n        if (c >= 0 && c % startWindowEvery === 0 && !this.closed) {\n            windows.shift().complete();\n        }\n        if (++this.count % startWindowEvery === 0 && !this.closed) {\n            const window = new Subject();\n            windows.push(window);\n            destination.next(window);\n        }\n    }\n    _error(err) {\n        const windows = this.windows;\n        if (windows) {\n            while (windows.length > 0 && !this.closed) {\n                windows.shift().error(err);\n            }\n        }\n        this.destination.error(err);\n    }\n    _complete() {\n        const windows = this.windows;\n        if (windows) {\n            while (windows.length > 0 && !this.closed) {\n                windows.shift().complete();\n            }\n        }\n        this.destination.complete();\n    }\n    _unsubscribe() {\n        this.count = 0;\n        this.windows = null;\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}